{% extends "!layout.html" %}

{% block extrahead %}
{{ super() }}
<script src="https://unpkg.com/mermaid@10.9.1/dist/mermaid.min.js"></script>
<script>
    mermaid.initialize({
        startOnLoad: true,
        theme: 'default',
        themeVariables: {
            primaryColor: '#f39c12',
            primaryTextColor: '#2c3e50',
            primaryBorderColor: '#e74c3c',
            lineColor: '#34495e',
            secondaryColor: '#ecf0f1',
            tertiaryColor: '#fff'
        },
        flowchart: {
            useMaxWidth: true,
            htmlLabels: true
        }
    });
</script>
{% endblock %}

{% block footer %}
{{ super() }}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Найти все блоки с классом mermaid и инициализировать их
        const mermaidBlocks = document.querySelectorAll('pre.mermaid');
        mermaidBlocks.forEach(function(block) {
            // Создать div элемент вместо pre
            const div = document.createElement('div');
            div.className = 'mermaid';
            div.innerHTML = block.textContent;
            
            // Заменить pre на div
            block.parentNode.replaceChild(div, block);
        });
        
        // Перезапустить mermaid
        mermaid.init();
    });
</script>
{% endblock %}