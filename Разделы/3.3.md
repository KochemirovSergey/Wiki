### 3.3. Планируемая стоимость продукта. Расчет себестоимости

[← Назад к оглавлению](#оглавление)


#### Структура операционных издержек

**1. Серверные издержки (статичные) - Российские провайдеры**

**Сравнение ведущих российских VPS провайдеров:**

| Провайдер | 4 ГБ RAM, 2 vCPU, 40 ГБ SSD | 8 ГБ RAM, 4 vCPU, 80 ГБ SSD | 16 ГБ RAM, 8 vCPU, 160 ГБ SSD |
|-----------|----------------------------|------------------------------|-------------------------------|
| **Selectel** | 800-1,200 руб/мес | 1,600-2,000 руб/мес | 3,200-4,000 руб/мес |
| **Timeweb** | 590-790 руб/мес | 1,180-1,580 руб/мес | 2,360-3,160 руб/мес |
| **Beget** | 983-1,200 руб/мес | 1,800-2,200 руб/мес | 3,600-4,400 руб/мес |
| **REG.RU** | 700-900 руб/мес | 1,400-1,800 руб/мес | 2,800-3,600 руб/мес |

**Итоговая конфигурация на Selectel:**

| Компонент | Конфигурация | Стоимость/месяц (Selectel) | Назначение |
|-----------|--------------|----------------------------|------------|
| **[Neo4j](glossarium.md#технологии-работы-с-данными) Database Server** | 8 ГБ RAM, 4 vCPU, 200 ГБ SSD | 1,800 руб | Графовая база данных |
| **Application Server** | 16 ГБ RAM, 8 vCPU, 160 ГБ SSD | 3,500 руб | Основное приложение |
| **Telegram Bot Server** | 4 ГБ RAM, 2 vCPU, 40 ГБ SSD | 900 руб | Telegram интерфейс |
| **Web Dashboard Server** | 8 ГБ RAM, 4 vCPU, 80 ГБ SSD | 1,800 руб | Веб-интерфейс |
| **[NLP](glossarium.md#основные-технологии-искусственного-интеллекта) Processing Server** | 8 ГБ RAM, 4 vCPU, 80 ГБ SSD | 1,800 руб | Предобработка документов, сокращение токенов |
| **Backup & Monitoring** | Дополнительные сервисы | 500 руб | Резервное копирование |
| **ИТОГО серверные издержки** | | **10,300 руб/месяц** | **123,600 руб/год** |

**Преимущества Selectel:**
- Дата-центры уровня Tier III в Москве, СПб и Ленобласти
- Почасовая оплата по модели pay-as-you-go
- Защита от DDoS-атак, API управление, техподдержка 24/7
- Соответствие 152-ФЗ, ISO 27001, ГОСТ Р 57580

**Альтернативы (экономия до 30%):**
- **Timeweb**: 8,000 руб/месяц (экономия 2,300 руб/месяц)
- **REG.RU**: 8,500 руб/месяц (экономия 1,800 руб/месяц)

**2. Издержки API (переменные)**

**Тарифы API для разных версий Claude:**

| Модель | Входящие токены (за млн) | Исходящие токены (за млн) | Назначение |
|--------|-------------------------|---------------------------|------------|
| **Claude 3.5 Sonnet** | $3.00 | $15.00 | Бесплатная квота, базовые функции |
| **Claude 4 Sonnet** | $3.00 | $15.00 | Платные тарифы, коммерческое использование |

**Дополнительные возможности Claude 4 Sonnet:**
- Prompt caching: скидка 75% на повторяющиеся входы (с $3.00 до $0.75 за млн токенов)
- Batch processing: скидка до 50% для неприоритетных задач
- Контекстное окно: 200,000 токенов
- Максимальный выход: 64,000 токенов

**Структура запроса пользователя:**
- Вызовов [LLM](glossarium.md#основные-технологии-искусственного-интеллекта) на итерацию: **2**
- Количество итераций: **3** 
- Общее количество вызовов на запрос: **6**
- Входящие токены на вызов: **5,000** (контекст)
- Исходящие токены на вызов: **200** (генерация)

**Расчет стоимости одного запроса:**
```
Входящие токены: 6 × 5,000 = 30,000 токенов
Исходящие токены: 6 × 200 = 1,200 токенов

Стоимость входящих: (30,000 / 1,000,000) × $3.00 = $0.09
Стоимость исходящих: (1,200 / 1,000,000) × $15.00 = $0.018
ИТОГО на запрос: $0.108 (≈ 10.8 рублей по курсу 100 руб/$)
```

**3. Издержки API на обработку документов (с NLP оптимизацией)**

При загрузке и обработке новых документов (ETL процесс) с использованием NLP для сокращения контекста:

**Оптимизация через [NLP](glossarium.md#основные-технологии-искусственного-интеллекта) preprocessing:**
- Исходный размер документа: **10,000 токенов**
- После [NLP](glossarium.md#основные-технологии-искусственного-интеллекта) обработки: **2,000 токенов** (сокращение на 80%)
- Количество итераций обработки: **5**
- **Оптимизированная стоимость обработки одного документа: $0.24 (≈24 рубля)**

**Расчет для оптимизированного документа:**
```
Обработка документа с [NLP](glossarium.md#основные-технологии-искусственного-интеллекта) (6,000 входящих + 2,000 исходящих токенов):
Входящие: (6,000 / 1,000,000) × $3.00 = $0.018
Исходящие: (2,000 / 1,000,000) × $15.00 = $0.03
Итераций обработки: 5
ИТОГО: ($0.018 + $0.03) × 5 = $0.24 ≈ 24 рубля
```

**Экономия:** 60 → 24 рубля (60% снижение затрат на обработку документов)


#### Структура издержек на создание БД

Количество таблиц - 750

Обработка одной таблицы 10х10: по 5 за итерацию - итого 20
В каждой итерации 2 да 3 запросов, в стреднем считаем 2: на входе 10000 на выходе 2000

Стоимость одного запроса 0.24 $ = 24 рубля
Тогда вся коллекция статистических форм: 750 (таблиц) *20 (итераций на таблицу)*2(запросов на итерацию)*24 (стоимость запроса)=720 000 рублей.


#### Структура издержек на локальное развертывание по тарифу 4

**GPU серверы Selectel для DeepSeek V3:**

| Конфигурация | GPU | Стоимость/месяц | Производительность | Назначение |
|-------------|-----|----------------|-------------------|------------|
| **GL1-H100-25GE** | 1× NVIDIA H100 80GB | 395,000 руб | ~85 токенов/сек | Средняя нагрузка |
| **GL2-H100-NVLink-25GE** | 2× NVIDIA H100 80GB | 807,000 руб | ~170 токенов/сек | Высокая нагрузка |

**Оптимизация производительности:**
- **Квантизация:** 4-bit AWQ позволяет разместить модель в 80GB VRAM одной H100
- **Качество:** незначительная деградация качества по сравнению с полной версией
- **Скорость:** 75-100 токенов/секунду на одной H100 с квантизацией

**Расчет производительности для H100 80GB с DeepSeek V3-0324:**

**Обработка запросов пользователей:**
- Исходящие токены на запрос: 1,200 токенов (6 вызовов × 200 токенов)
- Время генерации одного запроса: 1,200 ÷ 85 = ~14 секунд
- **Пропускная способность: ~257 запросов/час = 6,168 запросов/день**

**Обработка документов:**
- Исходящие токены на документ: 2,000 токенов (5 итераций × 400 токенов)
- Время обработки одного документа: 2,000 ÷ 85 = ~24 секунды
- **Пропускная способность: ~150 документов/час = 3,600 документов/день**

**Смешанный режим работы (50% запросы + 50% документы):**
- **Реальная производительность: 3,000 запросов + 1,800 документов в день**
- **Месячная производительность: 90,000 запросов + 54,000 документов**

**Сравнение с API-подходом:**
- API-подход (тариф "Госорганы"): 1,000 запросов + 100 документов/день
- Локальный сервер: 3,000 запросов + 1,800 документов/день
- **Увеличение производительности в 3-18 раз**
